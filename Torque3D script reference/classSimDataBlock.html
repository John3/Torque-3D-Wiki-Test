<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Torque 3D - Script Manual: SimDataBlock Class Reference</title>
<link href="torquedoc.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<table width="100%" class="header">
<tr>
<td style="background-image: url( 'images/t3d-documentation-header.png' ); height: 100px;">
   <!-- hack... makes the HTML Help compiler include the image into the project -->
   <img src="images/t3d-documentation-header.png" style="width: 0; height: 0; borders: 0;">
</td>
</tr>
<tr><td class="headermenu">
	<center>
	<a class="qindex" href="index.html">Main</a> &nbsp; 
	<a class="qindex" href="annotated.html">Class List</a> &nbsp; 
	<a class="qindex" href="namespaces.html">Namespace List</a>	&nbsp; 
	<a class="qindex" href="https://github.com/LuisAntonRebollo/Torque-3D-Wiki-Test/wiki">Wiki</a>
	</center>
</td></tr>
</table>
<br>
<!-- END HEADER -->
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">
<h1>SimDataBlock Class Reference<br/>
<small>
[<a class="el" href="group__Console.html">Console</a>]</small>
</h1><!-- doxytag: class="SimDataBlock" --><!-- doxytag: inherits="SimObject" -->
<p>Root DataBlock class.  
<a href="#_details">More...</a></p>
<div class="dynheader">
Inheritance diagram for SimDataBlock:</div>
<div class="dynsection">
<div class="center"><img src="classSimDataBlock__inherit__graph.png" border="0" usemap="#SimDataBlock_inherit__map" alt="Inheritance graph"/></div>
<map name="SimDataBlock_inherit__map" id="SimDataBlock_inherit__map">
<area shape="rect" href="classDecalData.html" title="A datablock describing an individual decal." alt="" coords="324,259,404,285"/><area shape="rect" href="classForestItemData.html" title="Base class for defining a type of ForestItem. It does not implement loading or rendering..." alt="" coords="309,309,419,336"/><area shape="rect" href="classGameBaseData.html" title="Scriptable, demo&#45;able datablock. Used by GameBase objects." alt="" coords="308,360,420,387"/><area shape="rect" href="classLightAnimData.html" title="A datablock which defines and performs light animation, such as rotation, brightness..." alt="" coords="311,411,417,437"/><area shape="rect" href="classLightDescription.html" title="A helper datablock used by classes (such as shapebase) that submit lights to the..." alt="" coords="307,461,421,488"/><area shape="rect" href="classLightFlareData.html" title="Defines a light flare effect usable by scene lights." alt="" coords="312,512,416,539"/><area shape="rect" href="classParticleData.html" title="Contains information for how specific particles should look and react including particle..." alt="" coords="319,563,409,589"/><area shape="rect" href="classPxMaterial.html" title="Defines a PhysX material assignable to PxMultiActorData." alt="" coords="323,613,405,640"/><area shape="rect" href="classReflectorDesc.html" title="A datablock which defines performance and quality properties for dynamic reflections..." alt="" coords="313,664,415,691"/><area shape="rect" href="classSFXAmbience.html" title="A datablock that describes an ambient sound space." alt="" coords="312,715,416,741"/><area shape="rect" href="classSFXDescription.html" title="A description for how a sound should be played." alt="" coords="309,765,419,792"/><area shape="rect" href="classSFXEnvironment.html" title="Description of a reverb environment." alt="" coords="307,816,421,843"/><area shape="rect" href="classSFXFMODEventGroup.html" title="A group of events in an imported FMOD Designer project." alt="" coords="289,867,439,893"/><area shape="rect" href="classSFXFMODProject.html" title="An FMOD Designer project loaded into Torque." alt="" coords="303,917,425,944"/><area shape="rect" href="classSFXState.html" title="A boolean switch used to modify playlist behavior." alt="" coords="327,968,401,995"/><area shape="rect" href="classSFXTrack.html" title="Abstract base class for sound data that can be played back by the sound system." alt="" coords="325,1019,403,1045"/><area shape="rect" href="classWheeledVehicleSpring.html" title="Defines the properties of a WheeledVehicle spring." alt="" coords="288,1069,440,1096"/><area shape="rect" href="classWheeledVehicleTire.html" title="Defines the properties of a WheeledVehicle tire." alt="" coords="296,1120,432,1147"/><area shape="rect" href="classSimObject.html" title="Base class for almost all objects involved in the simulation." alt="" coords="5,689,88,716"/><area shape="rect" href="classTSForestItemData.html" title="Concrete implementation of ForestItemData which loads and renders dts format shapeFiles..." alt="" coords="508,5,633,32"/><area shape="rect" href="classDebrisData.html" title="Stores properties for an individual debris type." alt="" coords="528,56,613,83"/><area shape="rect" href="classExplosionData.html" title="The data on what an explosion should look like. Definesa particle data, debris data..." alt="" coords="519,107,623,133"/><area shape="rect" href="classLightningData.html" title="An emitter for Lightning objects." alt="" coords="521,157,620,184"/><area shape="rect" href="classParticleEmitterData.html" title="Acts as the physical point in space in white Particles are created from. Also manages..." alt="" coords="504,208,637,235"/><area shape="rect" href="classParticleEmitterNodeData.html" title="Contains the timeMuliplier information to be assigned to a ParticleEmitterNode. The..." alt="" coords="489,259,652,285"/><area shape="rect" href="classPhysicsDebrisData.html" title="Defines the properties of a type of PhysicsDebrisData." alt="" coords="505,309,636,336"/><area shape="rect" href="classPhysicsShapeData.html" title="Defines the properties of a type of PhysicsShape." alt="" coords="505,360,636,387"/><area shape="rect" href="classPrecipitationData.html" title="Defines the droplets used in a storm (IE: raindrops, snowflakes, etc.)." alt="" coords="511,411,631,437"/><area shape="rect" href="classProjectileData.html" title="Stores properties for an individual projectile type." alt="" coords="520,461,621,488"/><area shape="rect" href="classPxMultiActorData.html" title="Defines the properties of a type of PxMultiActor." alt="" coords="509,512,632,539"/><area shape="rect" href="classShapeBaseData.html" title="Defines properties for a ShapeBase object." alt="" coords="513,563,628,589"/><area shape="rect" href="classShapeBaseImageData.html" title="Represents geometry to be mounted to a ShapeBase object." alt="" coords="496,613,645,640"/><area shape="rect" href="classSplashData.html" title="Acts as the physical point in space in white a Splash is created from." alt="" coords="527,664,615,691"/><area shape="rect" href="classTriggerData.html" title="Defines shared properties for Trigger objects." alt="" coords="527,715,615,741"/><area shape="rect" href="classCameraData.html" title="A datablock that describes a camera." alt="" coords="721,385,815,412"/><area shape="rect" href="classItemData.html" title="Stores properties for an individual Item type." alt="" coords="732,436,804,463"/><area shape="rect" href="classMissionMarkerData.html" title="A very basic class containing information used by MissionMarker objects for rendering..." alt="" coords="701,487,835,513"/><area shape="rect" href="classPathCameraData.html" title="General interface to control a PathCamera object from the script level." alt="" coords="708,537,828,564"/><area shape="rect" href="classPlayerData.html" title="Defines properties for a Player object." alt="" coords="725,588,811,615"/><area shape="rect" href="classRigidShapeData.html" title="Defines the physics properties for an individual RigidShapeData physics object." alt="" coords="711,639,825,665"/><area shape="rect" href="classStaticShapeData.html" title="The most basic ShapeBaseData derrived shape datablock available in Torque 3D." alt="" coords="708,689,828,716"/><area shape="rect" href="classVehicleData.html" title="Base properties shared by all Vehicles (FlyingVehicle, HoverVehicle, WheeledVehicle..." alt="" coords="723,740,813,767"/><area shape="rect" href="classFlyingVehicleData.html" title="Defines the properties of a FlyingVehicle." alt="" coords="892,689,1017,716"/><area shape="rect" href="classHoverVehicleData.html" title="Defines the properties of a HoverVehicle." alt="" coords="893,740,1016,767"/><area shape="rect" href="classWheeledVehicleData.html" title="Defines the properties of a WheeledVehicle." alt="" coords="884,791,1025,817"/><area shape="rect" href="classSFXFMODEvent.html" title="A playable sound event in an FMOD Designer audio project." alt="" coords="513,968,628,995"/><area shape="rect" href="classSFXPlayList.html" title="A datablock describing a playback pattern of sounds." alt="" coords="525,1019,616,1045"/><area shape="rect" href="classSFXProfile.html" title="Encapsulates a single sound file for playback by the sound system." alt="" coords="531,1069,611,1096"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classSimDataBlock-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimDataBlock.html#a43029248cfcc74a136596d533e1f01de">reloadOnLocalClient</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reload the datablock. This can only be used with a local client configuration.  <a href="#a43029248cfcc74a136596d533e1f01de"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Root DataBlock class. </p>
<h2><a class="anchor" id="SimDataBlock_intro">
Introduction</a></h2>
<p>Another powerful aspect of Torque's networking is the datablock. Datablocks are used to provide relatively static information about entities; for instance, what model a weapon should use to display itself, or how heavy a player class is.</p>
<p>This gives significant gains in network efficiency, because it means that all the datablocks on a server can be transferred over the network at client connect time, instead of being intertwined with the update code for NetObjects.</p>
<p>This makes the network code much simpler overall, as one-time initialization code is segregated from the standard object update code, as well as providing several powerful features, which we will discuss momentarily.</p>
<h2><a class="anchor" id="SimDataBlock_preload">
preload() and File Downloading</a></h2>
<p>Because datablocks are sent over the wire, using SimDataBlockEvent, before gameplay starts in earnest, we gain in several areas. First, we don't have to try to keep up with the game state while working with incomplete information. Second, we can provide the user with a nice loading screen, instead of the more traditional "Connecting..." message. Finally, and most usefully, we can request missing files from the server as we become aware of them, since we are under no obligation to render anything for the user.</p>
<p>The mechanism for this is fairly basic. After a datablock is unpacked, the preload() method is called. If it returns false and sets an error, then the network code checks to see if a file (or files) failed to be located by the ResManager; if so, then it requests those files from the server. If preload returns true, then the datablock is considered loaded. If preload returns false and sets no error, then the connection is aborted.</p>
<p>Once the file(s) is downloaded, the datablock's preload() method is called again. If it fails with the same error, the connection is aborted. If a new error is returned, then the download-retry process is repeated until the preload works.</p>
<h2><a class="anchor" id="SimDataBlock_guide">
Guide To Datablock Code</a></h2>
<p>To make a datablock subclass, you need to extend three functions:</p>
<ul>
<li>preload()</li>
<li>packData()</li>
<li>unpackData()</li>
</ul>
<p>packData() and unpackData() simply read or write data to a network stream. If you add any fields, you need to add appropriate calls to read or write. Make sure that the order of reads and writes is the same in both functions. Make sure to call the Parent's version of these methods in every subclass.</p>
<p>preload() is a bit more complex; it is responsible for taking the raw data read by unpackData() and processing it into a form useful by the datablock's owning object. For instance, the <a class="el" href="classPlayer.html" title="A client-controlled player character.">Player</a> class' datablock, <a class="el" href="classPlayerData.html" title="Defines properties for a Player object.">PlayerData</a>, gets handles to commonly used nodes in the player model, as well as resolving handles to textures and other resources. <b>Any</b> code which loads files or performs other actions beyond simply reading the data from the packet, such as validation, must reside in preload().</p>
<p>To write your own preload() methods, see any of the existing methods in the codebase; for instance, PlayerData::preload() is an excellent example of error-reporting, data validation, and so forth.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>A useful trick, which is used in several places in the engine, is that of temporarily storing SimObjectIds in the variable which will eventually hold the "real" handle. ShapeImage uses this trick in several pllaces; so do the vehicle classes. See <a class="el" href="classGameBaseData.html" title="Scriptable, demo-able datablock. Used by GameBase objects.">GameBaseData</a> for more on using this trick.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classGameBaseData.html" title="Scriptable, demo-able datablock. Used by GameBase objects.">GameBaseData</a> for some more information on the datablocks used throughout most of the engine. </dd></dl>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a43029248cfcc74a136596d533e1f01de"></a><!-- doxytag: member="SimDataBlock::reloadOnLocalClient" ref="a43029248cfcc74a136596d533e1f01de" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SimDataBlock::reloadOnLocalClient </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reload the datablock. This can only be used with a local client configuration. </p>

</div>
</div>
</div>

<!-- START FOOTER -->
<br>
<br>
<center>
	<div style="color: #777777;">
	Copyright &copy; <a style="color: #777777;" target="_blank" href="http://www.garagegames.com">GarageGames, LLC</a>. All Rights Reserved.
	</div>
</center>
</body>
</html>
