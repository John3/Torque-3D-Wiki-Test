<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Torque 3D - Script Manual: Game Objects</title>
<link href="torquedoc.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<table width="100%" class="header">
<tr>
<td style="background-image: url( 'images/t3d-documentation-header.png' ); height: 100px;">
   <!-- hack... makes the HTML Help compiler include the image into the project -->
   <img src="images/t3d-documentation-header.png" style="width: 0; height: 0; borders: 0;">
</td>
</tr>
<tr><td class="headermenu">
	<center>
	<a class="qindex" href="index.html">Main</a> &nbsp; 
	<a class="qindex" href="annotated.html">Class List</a> &nbsp; 
	<a class="qindex" href="namespaces.html">Namespace List</a>	&nbsp; 
	<a class="qindex" href="https://github.com/LuisAntonRebollo/Torque-3D-Wiki-Test/wiki">Wiki</a>
	</center>
</td></tr>
</table>
<br>
<!-- END HEADER -->
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">


<h1><a class="anchor" id="syntaxGameObjects">Game Objects </a></h1><p>The most complex aspect of TorqueScript involves dealing with game objects. Much of your object creation will be performed in the World Editor, but you should still know how to manipulate objects at a script level. One thing to remember is that everything in TorqueScript is an object: players, vehicles, items, etc.</p>
<p>Every object added in the level is saved to a mission file, which is written entirely in TorqueScript. This also means every game object is accessible from script. First, we will study the syntax of object creation.</p>
<h2><a class="anchor" id="obj_syntax">
Syntax</a></h2>
<p>Even though objects are originally created in C++, they are exposed to script in a way that allows them to be declared using the following syntax:</p>
<p><b>Object Definition:</b></p>
<div class="fragment"><pre class="fragment"> <span class="comment">// In TorqueScript</span>
%objectID = <span class="keyword">new</span> ObjectType(Name : CopySource, arg0, ..., argn) 
{
   &lt;datablock = DatablockIdentifier;&gt;
   
   [existing_field0 = InitialValue0;]
   ...
   [existing_fieldN = InitialValueN;]

   [dynamic_field0 = InitialValue0;]
   ...
   [dynamic_fieldN = InitialValueN;]
};
</pre></div><p><b>Syntax Breakdown:</b></p>
<ul>
<li><b>objectID</b> : Is the variable where the object's handle will be stored.</li>
</ul>
<ul>
<li><b>new</b> : Is a key word telling the engine to create an instance of the following ObjectType.</li>
</ul>
<ul>
<li><b>ObjectType</b> : Is any class declared in the engine or in script that has been derived from <a class="el" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a> or a subclass of <a class="el" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a>. SimObject-derived objects are what we were calling "game world objects" above.</li>
</ul>
<ul>
<li><b>Name (optional)</b> : Is any expression evaluating to a string, which will be used as the object's name.</li>
</ul>
<ul>
<li><b>CopySource (optional)</b> : The name of an object which is previously defined somewhere in script. Existing field values will be copied from CopySource to the new object being created. Any dynamic fields defined in CopySource will also be defined in the new object, and their values will be copied. Note: If CopySource is of a different ObjectType than the object being created, only CopySource's dynamic fields will be copied.</li>
</ul>
<ul>
<li><b>arg0, ..., argn (optional)</b> : Is a comma separated list of arguments to the class constructor (if it takes any).</li>
</ul>
<ul>
<li><b>datablock</b> : Many objects (those derived from <a class="el" href="classGameBase.html" title="Base class for game objects which use datablocks, networking, are editable, and need...">GameBase</a>, or children of <a class="el" href="classGameBase.html" title="Base class for game objects which use datablocks, networking, are editable, and need...">GameBase</a>) require datablocks to initialize specific attributes of the new object. Datablocks are discussed below.</li>
</ul>
<ul>
<li><b>existing_fieldN</b> : In addition to initializing values with a datablock, you may also initialize existing class members (fields) here. Note: In order to modify a member of a C++-defined class, the member must be exposed to the Console. This concept is discussed in detail later.</li>
</ul>
<ul>
<li><b>dynamic_fieldN</b> : Lastly, you may create new fields (which will exist only in Script) for your new object. These will show up as dynamic fields in the World Editor Inspector. <br/>
</li>
</ul>
<p>The main object variants you can create are SimObjects without a datablock, and game objects which require a datablock. The most basic <a class="el" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a> can be created in a single line of code:</p>
<p><b>Example:</b></p>
<div class="fragment"><pre class="fragment"><span class="comment">// Create a SimObject without any name, argument, or fields.</span>
$exampleSimObject = <span class="keyword">new</span> <a class="code" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a>();
</pre></div><p>The $exampleSimObject variable now has access to all the properties and functions of a basic SimOBject. Usually, when you are creating a <a class="el" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a> you will want custom fields to define features</p>
<p><b>Example:</b></p>
<div class="fragment"><pre class="fragment"><span class="comment">// Create a SimObject with a custom field</span>
$exampleSimObject = <span class="keyword">new</span> <a class="code" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a>() 
{
   catchPhrase = <span class="stringliteral">&quot;Hello world!&quot;</span>;
};
</pre></div><p>As with the previous example, the above code creates a <a class="el" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a> without a name which can be referenced by the global variable $exampleSimObject. This time, we have added a user defined field called "catchPhrase." There is not a single stock Torque 3D object that has a field called "catchPhrase." However, by adding this field to the <a class="el" href="classSimObject.html" title="Base class for almost all objects involved in the simulation.">SimObject</a> it is now stored as long as that object exists.</p>
<p>The other game object variant mentioned previously involves the usage of datablocks. Datablocks contain static information used by a game object with a similar purpose. Datablocks are transmitted from a server to client, which means they cannot be modified while the game is running.</p>
<p>We will cover datablocks in more detail later, but the following syntax shows how to create a game object using a datablock.</p>
<p><b>Example:</b></p>
<div class="fragment"><pre class="fragment"><span class="comment">// create a StaticShape using a datablock</span>
datablock <a class="code" href="classStaticShapeData.html" title="The most basic ShapeBaseData derrived shape datablock available in Torque 3D.">StaticShapeData</a>(ceiling_fan)
{
   category = <span class="stringliteral">&quot;Misc&quot;</span>;
   shapeFile = <span class="stringliteral">&quot;art/shapes/undercity/cfan.dts&quot;</span>;
   isInvincible = <span class="keyword">true</span>;
};

<span class="keyword">new</span> <a class="code" href="classStaticShape.html" title="The most basic 3D shape with a datablock available in Torque 3D.">StaticShape</a>(CistFan) 
{
   dataBlock = <span class="stringliteral">&quot;ceiling_fan&quot;</span>;
   position = <span class="stringliteral">&quot;12.5693 35.5857 59.5747&quot;</span>;
   rotation = <span class="stringliteral">&quot;1 0 0 0&quot;</span>;
   scale = <span class="stringliteral">&quot;1 1 1&quot;</span>;
};
</pre></div><p>Once you have learned about datablocks, the process is quite simple:</p>
<ol>
<li>
Create a datablock in script, or using the datablock editor </li>
<li>
Add a shape to the scene from script or using the World Editor </li>
<li>
Assign the new object a datablock </li>
</ol>
<p><br/>
</p>
<h2><a class="anchor" id="hand_vs_name">
Handles vs Names</a></h2>
<p>Every game object added to a level can be accessed by two parameters:</p>
<ul>
<li><b>Handle</b> - A unique numeric ID generated when the object is created</li>
</ul>
<ul>
<li><b>Name</b> - This is an optional parameter given to an object when it is created. You can assign a name to an object from the World Editor, or do so in TorqueScript using the following syntax:</li>
</ul>
<p><b>Example:</b></p>
<div class="fragment"><pre class="fragment"><span class="comment">// In this example, CistFan is the name of the object</span>
<span class="keyword">new</span> <a class="code" href="classStaticShape.html" title="The most basic 3D shape with a datablock available in Torque 3D.">StaticShape</a>(CistFan) 
{
   dataBlock = <span class="stringliteral">&quot;ceiling_fan&quot;</span>;
   position = <span class="stringliteral">&quot;12.5693 35.5857 59.5747&quot;</span>;
   rotation = <span class="stringliteral">&quot;1 0 0 0&quot;</span>;
   scale = <span class="stringliteral">&quot;1 1 1&quot;</span>;
};
</pre></div><p>While in the World Editor, you will not be allowed to assign the same name to multiple, separate objects. The editor will ignore the attempt. If you manually name two objects the same thing in script, the game will only load the first object and ignore the second. <br/>
<br/>
<br/>
</p>
<h2><a class="anchor" id="syntax_singletons">
Singletons</a></h2>
<p>If you need a global script object with only a single instance, you can use the singleton keyword. Singletons, in TorqueScript, are mostly used for unique shaders, materials, and other client-side only objects.</p>
<p>For example, SSAO (screen space ambient occlusion) is a post-processing effect. The game will only ever need a single instance of the shader, but it needs to be globally accessible on the client. The declaration of the SSAO shader in TorqueScript can be shown below:</p>
<div class="fragment"><pre class="fragment">singleton <a class="code" href="classShaderData.html" title="Special type of data block that stores information about a handwritten shader.">ShaderData</a>( SSAOShader )
{   
   DXVertexShaderFile   = <span class="stringliteral">&quot;shaders/common/postFx/postFxV.hlsl&quot;</span>;
   DXPixelShaderFile    = <span class="stringliteral">&quot;shaders/common/postFx/ssao/SSAO_P.hlsl&quot;</span>;            
   pixVersion = 3.0;
};
</pre></div><p> <br/>
</p>
<h2><a class="anchor" id="syntax_obj_meth">
Methods</a></h2>
<p>In addition to the creation of stand-alone functions, TorqueScript allows you to create and call methods attached to objects. Some of the more important ConsoleMethods are already written in C++, then exposed to script. You can call these methods by using the dot (.) notation.</p>
<p><b>Syntax:</b></p>
<div class="fragment"><pre class="fragment">objHandle.function_name();

objName.function_name();
</pre></div><p><b>Example:</b></p>
<div class="fragment"><pre class="fragment"><span class="keyword">new</span> <a class="code" href="classStaticShape.html" title="The most basic 3D shape with a datablock available in Torque 3D.">StaticShape</a>(CistFan) 
{
   dataBlock = <span class="stringliteral">&quot;ceiling_fan&quot;</span>;
   position = <span class="stringliteral">&quot;12.5693 35.5857 59.5747&quot;</span>;
   rotation = <span class="stringliteral">&quot;1 0 0 0&quot;</span>;
   scale = <span class="stringliteral">&quot;1 1 1&quot;</span>;
};

<span class="comment">// Write all the objects methods to the console log</span>
CistFan.dump();

<span class="comment">// Get the ID of an object, using the object&#39;s name</span>
$objID = CistFan.getID();

<span class="comment">// Print the ID to the console</span>
<a class="code" href="group__Logging.html#gadda60a90d6b71f2d19f027847c0cb6f9" title="Logs a message to the console.">echo</a>(<span class="stringliteral">&quot;Object ID: &quot;</span>, $objID);

<span class="comment">// Get the object&#39;s position, using the object&#39;s handle</span>
%position = $objID.getPosition();

<span class="comment">// Print the position to the console</span>
<a class="code" href="group__Logging.html#gadda60a90d6b71f2d19f027847c0cb6f9" title="Logs a message to the console.">echo</a>(<span class="stringliteral">&quot;Object Position: &quot;</span>, %position);
</pre></div><p>The above example shows how you can call an object's method by using its name or a variable containing its handle (unique ID number). Additionally, TorqueScript supports the creation of methods that have no associated C++ counterpart.</p>
<p><b>Syntax:</b></p>
<div class="fragment"><pre class="fragment"><span class="comment">// function - Is a keyword telling TorqueScript we are defining a new function.</span>
<span class="comment">// ClassName::- Is the class type this function is supposed to work with.</span>
<span class="comment">// function_name - Is the name of the function we are creating.</span>
<span class="comment">// ... - Is any number of additional arguments.</span>
<span class="comment">// statements - Your custom logic executed when function is called</span>
<span class="comment">// %this- Is a variable that will contain the handle of the &#39;calling object&#39;.</span>
<span class="comment">// return val - The value the function will give back after it has completed. Optional.</span>

function Classname::func_name(%<span class="keyword">this</span>, [arg0],...,[argn]) 
{
   statements;
   [<span class="keywordflow">return</span> val;]
}
</pre></div><p>At a minimum, object methods require that you pass them an object handle. You will often see the first argument named this. People use this as a hint, but you can name it anything you want. As with Console functions any number of additional arguments can be specified separated by commas.</p>
<p>As a simple example, let's say there is an object called Samurai, derived from the <a class="el" href="classPlayer.html" title="A client-controlled player character.">Player</a> class. It is likely that a specific appearance and play style will be given to the samurai, so custom ConsoleMethods can be written. Here is a sample:</p>
<p><b>Example:</b></p>
<div class="fragment"><pre class="fragment">function Samurai::sheatheSword(%<span class="keyword">this</span>)
{
    <a class="code" href="group__Logging.html#gadda60a90d6b71f2d19f027847c0cb6f9" title="Logs a message to the console.">echo</a>(<span class="stringliteral">&quot;Katana sheathed&quot;</span>);
}
</pre></div><p>When you add a Samurai object to your level via the World Editor, it will be given an ID. Let's pretend the handle (ID number) is 1042. We can call its ConsoleMethod once it is defined, using the period syntax:</p>
<p><b>Example:</b></p>
<div class="fragment"><pre class="fragment">1042.sheatheSword();

<span class="comment">// OUTPUT: &quot;Katana sheathed&quot;</span>
</pre></div><p>Notice that no parameters were passed into the function. The this parameter is inherent, and the original function did not require any other parameters. </p>
</div>

<!-- START FOOTER -->
<br>
<br>
<center>
	<div style="color: #777777;">
	Copyright &copy; <a style="color: #777777;" target="_blank" href="http://www.garagegames.com">GarageGames, LLC</a>. All Rights Reserved.
	</div>
</center>
</body>
</html>
